
# 地形生成

### Notch 的想法

- 第 1 版: 朴素柏林噪声
  - 考虑一张网格纸, 每个格子称为晶格. 每个晶格的交界点都生成 方向随机 + 长度随机的向量. 
    对于每个晶格, 都可以将它 4 个顶点的随机向量进行插值权重得到一个偏移向量. 
    然后让网格的中心点按照偏移向量的方向和长度移动, 如此就能得到一个随机位置的点. 
    并且一旦连接这些随机的点, 可以得到在晶格之间也平滑过渡的噪声. 
    所以这种噪声可以作为地形的平面图, 将偏移向量的长度作为这一点的方块高度值. 
    由于类似的原因, 晶格之间的高度变化也是平滑的, 不会产生骤变, 不会导致网格状伪影.  

- 第 2 版: 地形生成优化版柏林噪声
  - 在高度值前面加上负号, 此时地形会反向生成, 得到陷下去的湖泊. 
  - 让随机数生成在一个小区间内, 此时高度的变化更加平缓, 得到平坦的草原地形. 
  - 同理, 随机数生成在大区间内, 此时得到的地形是凸起的丘陵. 

- 第 3 版: 对生成机制的修复
  - 到现在为止, 这种地形生成方案所使用的柏林噪声依旧是单层的. 
    为了解决这个问题, Notch 引入了 FBM (分形布朗运动) 从而使用多层柏林噪声. 
  - 借助 FBM, 可以得到两种典型的应用
    1. 柏林噪声的嵌套. 在这种设计下, 生成器会先使用低频的柏林噪声为地形创造出大致的形状, 
       然后在形状上使用高频的柏林噪声, 雕刻出不同的细节. 
    2. 柏林噪声的结合. 组合柏林噪声生成的结果: 
       山上可以长出小山包; 丘陵可以出现在草原中间; 森林里面能产生湖泊.   
    进而生成更加多元的地形. 

- 第 4 版: Biome 分布
  -  借助 Voronoi 图确定 Biome 的分布, 无论沿着哪个方向移动都能遇见新的群系. 
